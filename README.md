# VoiceFront119_AI

# ASR 기반 119 음성 신고 지원 시스템

## ⚙️ 주요 기능

### 🗣️ 1. 구음장애인 고려 ASR 시스템
- Whisper Medium 모델을 **구음장애인 데이터로 파인튜닝**
- 구음장애인과 비장애인의 발화 **모두 텍스트 변환**


### 🚨 2. 신고 긴급도 분류 및 대응 우선순위 추천
- 딥러닝 기반 분류 모델로 신고의 **긴급도 상·중·하 분류**
- 동시간대 다수 신고 발생 시 **우선 대응 순서 제안**


### 📄 3. 신고 내용 요약 및 핵심 정보 추출
- GPT-4 Turbo를 이용한 **요약**
- 위치, 사고 유형, 환자 상태 등 **핵심 정보 추출**
<br><br>
---
## 🗂️ 데이터
- 구음장애 음성인식 데이터

https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=608

<br>

- 위급상황 음성/음향 고도화 - 119 지능형 신고접수 음성 인식 데이터

https://www.aihub.or.kr/aihubdata/data/view.do?currMenu=115&topMenu=100&aihubDataSe=data&dataSetSn=71768
<br><br><br>

---
## 🧠 모델 학습

### 🗣️ 구음 장애인 고려 ASR 시스템
### 적용 모델
- Whisper Medium 모델을 구음장애인 데이터로 파인튜닝
- LoRa 파인튜닝 적용

### 📊 학습 방법 및 데이터셋 구성
- 구음장애 데이터랑 119 신고 음성 데이터를 9:1 비율로 구성해서 학습

- 데이터셋 구성 <br>
Total dataset len : 4880 <br>
Train dataset len : 3904 <br>
Validation dataset len : 488  <br>
Test dataset len : 488
<br><br>
---
### 🚨 긴급도 분류 모델

### 📁 모델 학습 과정
#### 전처리
- 개인정보 마스킹만 불용어 처리

- 특수문자, 공백, 반복단어, 불용어 제거 등의 기본적인 텍스트 정제만 수행

- 통화 길이가 일정 기준 미만인 경우 제외

#### 텍스트 임베딩 

- Kc-Electra 모델을 사용하여 119 신고 텍스트를 임베딩

#### 추가 피처: 재난 유형 원핫 인코딩

- 재난 유형을 긴급도 기준으로 3개 그룹으로 맵핑 <br>
긴급도 상이 가장 많은 재난 유형 그룹 = High_Urgency_Group <br>
긴급도 중이 가장 많은 재난 유형 그룹 = Medium_Urgency_Group <br>
긴급도 하가 가장 많은 재난 유형 그룹 = Low_Urgency_Group  <br>

- 그룹 정보를 원핫 인코딩하여 추가 피처로 활용

#### 분류 모델 
- 텍스트 임베딩과 재난 유형 인코딩을 입력으로 사용

- MLP(Multi Layer Perceptron) 모델을 통해 긴급도 분류 수행
<br>

### 📊 데이터셋 구성
- Total dataset len <br>
긴급도 상 = 39299 <br>
긴급도 중 = 39299 <br>
긴급도 하 = 39299 <br>

- Train dataset len <br>
긴급도 상 = 31439 <br>
긴급도 중 = 31439 <br>
긴급도 하 = 31439 <br>

- Validation dataset len <br>
긴급도 상 = 3930 <br>
긴급도 중 = 3930 <br>
긴급도 하 = 3930 <br>

- Test dataset len <br>
긴급도 상 = 3930 <br>
긴급도 중 = 3930 <br>
긴급도 하 = 3930 
<br>

### ⚖️ 우선순위 알고리즘
긴급도 : 재난유형 = 5 : 5 비율로 반영하여 5점 만점제 <br>
점수 높을수록 대응 우선 순위 높음 <br>

**1. 긴급도에 대해** <br>
상 = 5점 <br>
중 = 3점 <br>
하 = 1점 <br>

**2. 재난유형에 대해** <br>
High_Urgency_Group = 5점 <br>
Medium_Urgency_Group = 3점 <br>
Low_Urgency_Group = 1점 <br><br>

---
### 📄 신고 내용 요약 및 핵심 정보 추출 
1. stt_result : STT 변환 (wav -> text)   <br>

2. urgency_classification : 긴급도 분류 (text -> text)  <br>

3. gpt_response : 요약 및 정리 (text -> text) <br>
**"role"** : "system" <br>
**"content"** :""" <br>
당신은 119 대원들의 신고 접수를 돕는 시스템이다. <br>
신고 내용을 기반으로 핵심 정보를 요약하고 119 출동 대원이 빠르게 파악할 수 있도록 정리해야 한다. <br>
**작성 지침**  <br>
모든 항목은 아이템 형태(• 또는 -)로 간결하게 작성한다.  <br>
신고 위치와 신고 내용은 반드시 포함되어야 한다.  <br>
구조/구급 상황일 경우:  <br>
환자와 신고자의 관계 <br>
환자의 상태 또는 증상 등  <br>
화재 상활일 경우:  <br>
화재 발생 위치  <br>
현재 진행 상황 (연기, 화염, 대피 여부 등) 등  <br>
주어지지 않은 정보를 허위로 작성해선 안 된다.  <br>
그 외 유의사항이나 추가 확인이 필요한 정보는 "비고" 함목에 명확히 정리한다.  <br>
모든 내용은 한국어로 작성하고, 출동 대원이 즉시 파악할 수 있도록 한다. <br><br>

---
## 📈 성능

### 📝 구음 장애인 고려 ASR 시스템 성능 분석
#### 기존 모델 vs 개선 모델
- **whisper-medium(기존모델) 오류율** <br>
WER (Word Error Rate): 59.3029%  <br>
CER (Character Error Rate): 35.8666%

- **파인튜닝하여 개선된 모델 오류율** <br>
WER (Word Error Rate): 28.0354%  <br>
CER (Character Error Rate): 12.1844%

#### 🔍 분석 결과 
WER 52.73% 향상 <br>
CER 66.03% 향상<br>

---

### 📝 긴급도 분류 모델 성능 분석
#### 기존 모델 vs 개선 모델

- 기존 모델 성능 ( 긴급 / 비긴급 분류 정확도 )

기존 모델 : 부산 소방재난본부 긴급도 분류 모델

긴급 → 긴급(97%), 비긴급(3%)  

비긴급 → 비긴급(45%), 긴급(55%)   

<br>

- 개발 모델 성능 

| 구분           | 정밀도 | 재현율 | F1-score |
|----------------|--------|--------|----------|
| 긴급도 하       | 52%    | 54%    | 53%      |
| 긴급도 중       | 49%    | 58%    | 52.5%    |
| **하 + 중 평균** | **50.5%** | **56%** | **52.8%** |
| **긴급도 상**       | **92%**    | **57%**    | **70%**      |
<br>

#### 🔍 분석 결과 
- **비긴급** <br>

**기존 모델** <br>
비긴급 상황에서는 정확도가 45%에 불과해 절반 이상을 긴급으로 오분류, 이는 현장에서 불필요한 출동과 자원 낭비, 과잉 대응으로 이어질 수 있음 <br>

반면 **개선 모델**은 비긴급 클래스(긴급도 하+중)를 묶었을 때 
재현율 58%, 정밀도 49%, F1-score 52.5%를 기록하여 <br>
기존 모델보다 **더 많은 비긴급 상황을 놓치지 않고 식별**할 수 있으며, 
**출동 판단 시 현장 자원을 보다 효율적으로 운용**할 수 있는 가능성을 보여줌 <br>

→  따라서 실제 운영에서는 비긴급 상황을 더 잘 걸러내어 현장 대응을 더 정교하게 만들고, 
불필요한 출동을 방지하는 데 실질적 도움을 줄 수 있음 

<br>

- **긴급** <br>

**개선 모델** <br>
긴급도 상 클래스에서 **정밀도 92%**로 오경보가 매우 적으며, **F1-score가 70%**로 균형 잡힌 성능을 보임 <br>

→  따라서 실제 운영에서는 불필요한 출동을 줄이면서도, 일정 수준의 탐지력은 확보해 현장 효율성을 높일 수 있음


<br>
